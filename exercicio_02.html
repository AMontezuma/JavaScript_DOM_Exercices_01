<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript DOM Exercices - 01</title>
    <!-- Isso carrega as folhas de estilo da p√°gina -->
    <link rel="stylesheet" href="./style.css">
</head>

<body>

    <h2>Formul√°rio de Contatos</h2>

    <form name="contato" method="post" action="#" id="contato">

        <p>Preencha todos os campos do formul√°rio para entrar em contato conosco:</p>
        <p class="small-red-center">Todos os campos s√£o obrigat√≥rios.</p>

        <p>
            <label for="nome">Nome:</label>
            <input type="text" name="nome" id="nome" placeholder="Seu nome completo.">
        </p>

        <p>
            <label for="email">E-mail:</label>
            <input type="email" name="email" id="email" placeholder="Seu e-mail principal.">
        </p>

        <p>
            <label for="assunto">Assunto:</label>
            <input type="text" name="assunto" id="assunto" placeholder="Assunto do seu contato.">
        </p>

        <p>
            <label for="mensagem">Mensagem:</label>
            <textarea name="mensagem" id="mensagem" placeholder="Mensagem do contato."></textarea>
        </p>
        <p>
            <button type="submit">Enviar</button>
            <small>&larr; Clique somente uma vez.</small>
        </p>

    </form>

    <div id="feedback">
        <div id="feedbackText"></div>
    </div>

    <footer>&copy; Copyright 2022 Carlos üëç</footer>

    <script>

        /**
         * Esta p√°gina √© apenas um modelo para as p√°ginas com os exerc√≠cios.
         * Lembre-se de seguir as instru√ß√µes nas "Anota√ß√µes de aula" para 
         * executar os exerc√≠cios corretamente.
         */

        /******************************************************
         * Declarando todas as vari√°veis e fun√ß√µes do script. *
         ******************************************************/

        /**
         * Esta fun√ß√£o processa o formulario quando este for enviado.
         * A maior parte dos c√≥digos ser√° criada aqui.
         * Isso √© uma 'arrow function'
         */
        var processaContato = () => {
            console.log('Processando...');

            /**
             * Essa deve ser a √∫ltima linha desta fun√ß√£o.
             * Ela conclui a fun√ß√£o sem fazer mais nada.
             * Isso impede que o HTML retome o controla e envie o formul√°rio 
             * novamente.
             */
            return false;
        }

        /**
         * Esta fun√ß√£o salva os dados do formul√°rio enviado no armazenamento local do navegador.
         * Ela serve como um teste de envio do formul√°rio.
         * Para acessar o 'Loca Storage' no Chrome, nas ferramentas do desenvolvedor (tela [F12]), 
         * acesse a op√ß√£o 'Aplicativo' ‚Üí 'Armazenamento local'
         * 
         * Importante! O par√¢metro 'contatoDados' deve ser um objeto JavaScript.
         * 
         * Exemplo de uso:
         *   enviaContato({
         *     nome: 'Joca da Silva',
         *     email: 'joca@silca',
         *     assunto: 'Teste de contato',
         *     mensagem: 'Isso √© um teste'
         *     data: '2022-02-02 10:15:18'
         *   });
         * 
         *   Refer√™ncias:
         *     ‚Ä¢ Local Storage ‚Üí https://www.w3schools.com/js/js_api_web_storage.asp
         *     ‚Ä¢ Local Storage ‚Üí https://www.w3schools.com/jsref/prop_win_localstorage.asp
         *     ‚Ä¢ JSON ‚Üí https://www.w3schools.com/js/js_json_intro.asp
         *     ‚Ä¢ JSON.stringify ‚Üí https://www.w3schools.com/js/js_json_stringify.asp
         *     ‚Ä¢ Date() ‚Üí https://www.w3schools.com/jsref/jsref_obj_date.asp
         *     ‚Ä¢ getTime() ‚Üí https://www.w3schools.com/jsref/jsref_gettime.asp
         *     ‚Ä¢ document.querySelector() ‚Üí https://www.w3schools.com/jsref/met_document_queryselector.asp
         */

        var enviaContato = (contatoDados) => {

            // Se os dados n√£o s√£o passados em um objeto...
            if (typeof contatoDados !== 'object') {

                // Gera mensagem de erro.
                let message = `Erro ao salvar os dados. Estavamos esperando um objeto.`;

                // Exibe erro no console.
                console.error(message);

                // Retorna um objeto com o status 'false' e mensagem de erro.
                return { status: false, message: message };

                // Se os dados est√£o em um objeto...
            } else {

                // Obt√©m a data atual em timestamp para servir de √≠ndice.
                let agora = new Date().getTime();

                // Converte os dados de objeto para uma string (JSON).
                let dados = JSON.stringify(contatoDados);

                // Salva no armazenamento local do browser e, se deu certo...
                if (localStorage.setItem(agora, dados)) {

                    // Gera mensagem de sucesso.
                    let message = `Contato enviado com sucesso.`;

                    // Exibe mensagem no console.
                    console.log(message);

                    // Retorna um objeto com o status 'true' e mensagem de sucesso.
                    return { status: true, message: message };
                } else {
                    let message = 'OoOops... It seems like we weren`t able to send your contact!';
                    console.erro(message);
                    return {
                        status: false, message: message
                    };
                };
            }
        }

        /**
         * Esta fun√ß√£o √© um atalho para selecionar um elemento √∫nico do HTML,
         * usando o seletor deste, de forma similar a 
         * 'document.getElementById()'.
         * 
         * Observe que somente o primeiro elemento do seletor √© retornado.
         * Se houverem outros, estes ser√£o ignorados.
         * 
         * Exemplos de uso:
         *    el('#feedback').innerHTML = 'Teste';
         *    el('button').disabled;
         */
        var el = (seletor) => {
            return document.querySelector(seletor);
        }

        /**
         * Monitora o envio do formul√°rio, chamando 'enviaContato()' se 
         * ocorrer.
         */
        el('#contato').onsubmit = processaContato;

        /*************************************************
         * Testes unit√°rios para as fun√ß√µes.             *
         * Descomente essas linhas para fazer os testes. *
         *************************************************/

        // console.log(el('#contato').name);

        // enviaContato({ nome: 'Joca da Silva', email: 'joca@silva', assunto: 'Teste de contato', mensagem: 'Isso √© um teste' });

    </script>

</body>

</html>